link = 'https://ui.adsabs.harvard.edu/abs/2013A%26A...550A...4H/abstract'
bibtex = \
"""
@ARTICLE{2013A&A...550A...4H,
       author = {{H.~E.~S.~S. Collaboration} and {Abramowski}, A. and {Acero}, F. and {Aharonian}, F. and {Akhperjanian}, A.~G. and {Anton}, G. and {Balenderan}, S. and {Balzer}, A. and {Barnacka}, A. and {Becherini}, Y. and {Becker Tjus}, J. and {Bernl{\"o}hr}, K. and {Birsin}, E. and {Biteau}, J. and {Bochow}, A. and {Boisson}, C. and {Bolmont}, J. and {Bordas}, P. and {Brucker}, J. and {Brun}, F. and {Brun}, P. and {Bulik}, T. and {Carrigan}, S. and {Casanova}, S. and {Cerruti}, M. and {Chadwick}, P.~M. and {Charbonnier}, A. and {Chaves}, R.~C.~G. and {Cheesebrough}, A. and {Cologna}, G. and {Conrad}, J. and {Couturier}, C. and {Dalton}, M. and {Daniel}, M.~K. and {Davids}, I.~D. and {Degrange}, B. and {Deil}, C. and {deWilt}, P. and {Dickinson}, H.~J. and {Djannati-Ata{\"\i}}, A. and {Domainko}, W. and {O'C. Drury}, L. and {Dubus}, G. and {Dutson}, K. and {Dyks}, J. and {Dyrda}, M. and {Egberts}, K. and {Eger}, P. and {Espigat}, P. and {Fallon}, L. and {Farnier}, C. and {Fegan}, S. and {Feinstein}, F. and {Fernandes}, M.~V. and {Fernandez}, D. and {Fiasson}, A. and {Fontaine}, G. and {F{\"o}rster}, A. and {F{\"u}{\ss}ling}, M. and {Gajdus}, M. and {Gallant}, Y.~A. and {Garrigoux}, T. and {Gast}, H. and {Giebels}, B. and {Glicenstein}, J.~F. and {Gl{\"u}ck}, B. and {G{\"o}ring}, D. and {Grondin}, M. -H. and {H{\"a}ffner}, S. and {Hague}, J.~D. and {Hahn}, J. and {Hampf}, D. and {Harris}, J. and {Heinz}, S. and {Heinzelmann}, G. and {Henri}, G. and {Hermann}, G. and {Hillert}, A. and {Hinton}, J.~A. and {Hofmann}, W. and {Hofverberg}, P. and {Holler}, M. and {Horns}, D. and {Jacholkowska}, A. and {Jahn}, C. and {Jamrozy}, M. and {Jung}, I. and {Kastendieck}, M.~A. and {Katarzy{\'n}ski}, K. and {Katz}, U. and {Kaufmann}, S. and {Kh{\'e}lifi}, B. and {Klochkov}, D. and {Klu{\'z}niak}, W. and {Kneiske}, T. and {Komin}, Nu. and {Kosack}, K. and {Kossakowski}, R. and {Krayzel}, F. and {Laffon}, H. and {Lamanna}, G. and {Lenain}, J. -P. and {Lennarz}, D. and {Lohse}, T. and {Lopatin}, A. and {Lu}, C. -C. and {Marandon}, V. and {Marcowith}, A. and {Masbou}, J. and {Maurin}, G. and {Maxted}, N. and {Mayer}, M. and {McComb}, T.~J.~L. and {Medina}, M.~C. and {M{\'e}hault}, J. and {Menzler}, U. and {Moderski}, R. and {Mohamed}, M. and {Moulin}, E. and {Naumann}, C.~L. and {Naumann-Godo}, M. and {de Naurois}, M. and {Nedbal}, D. and {Nguyen}, N. and {Niemiec}, J. and {Nolan}, S.~J. and {Ohm}, S. and {de O{\~n}a Wilhelmi}, E. and {Opitz}, B. and {Ostrowski}, M. and {Oya}, I. and {Panter}, M. and {Parsons}, D. and {Paz Arribas}, M. and {Pekeur}, N.~W. and {Pelletier}, G. and {Perez}, J. and {Petrucci}, P. -O. and {Peyaud}, B. and {Pita}, S. and {P{\"u}hlhofer}, G. and {Punch}, M. and {Quirrenbach}, A. and {Raue}, M. and {Reimer}, A. and {Reimer}, O. and {Renaud}, M. and {de los Reyes}, R. and {Rieger}, F. and {Ripken}, J. and {Rob}, L. and {Rosier-Lees}, S. and {Rowell}, G. and {Rudak}, B. and {Rulten}, C.~B. and {Sahakian}, V. and {Sanchez}, D.~A. and {Santangelo}, A. and {Schlickeiser}, R. and {Schulz}, A. and {Schwanke}, U. and {Schwarzburg}, S. and {Schwemmer}, S. and {Sheidaei}, F. and {Skilton}, J.~L. and {Sol}, H. and {Spengler}, G. and {Stawarz}, {\L}. and {Steenkamp}, R. and {Stegmann}, C. and {Stinzing}, F. and {Stycz}, K. and {Sushch}, I. and {Szostek}, A. and {Tavernet}, J. -P. and {Terrier}, R. and {Tluczykont}, M. and {Valerius}, K. and {van Eldik}, C. and {Vasileiadis}, G. and {Venter}, C. and {Viana}, A. and {Vincent}, P. and {V{\"o}lk}, H.~J. and {Volpe}, F. and {Vorobiov}, S. and {Vorster}, M. and {Wagner}, S.~J. and {Ward}, M. and {White}, R. and {Wierzcholska}, A. and {Wouters}, D. and {Zacharias}, M. and {Zajczyk}, A. and {Zdziarski}, A.~A. and {Zech}, A. and {Zechlin}, H. -S.},
        title = "{Measurement of the extragalactic background light imprint on the spectra of the brightest blazars observed with H.E.S.S.}",
      journal = {\aap},
     keywords = {gamma rays: galaxies, cosmic background radiation, BL Lacertae objects: general, Astrophysics - High Energy Astrophysical Phenomena, Astrophysics - Cosmology and Nongalactic Astrophysics},
         year = 2013,
        month = feb,
       volume = {550},
          eid = {A4},
        pages = {A4},
          doi = {10.1051/0004-6361/201220355},
archivePrefix = {arXiv},
       eprint = {1212.3409},
 primaryClass = {astro-ph.HE},
       adsurl = {https://ui.adsabs.harvard.edu/abs/2013A&A...550A...4H},
      adsnote = {Provided by the SAO/NASA Astrophysics Data System}
}
"""

notes = \
"""
Notes:
- Different magnitude range for each wavelength!
- Included systematic errors are ordered as +/-
- Units are all nW m^-2 sr^-1
"""


#raw_lower_xy = [
#(0.3030470289908728, 2.400320220672348),
#(0.33955400034789474, 2.735932643254051),
#(0.382838362071776, 3.2802716155103417),
#(0.4033900701475849, 3.592463910172399),
#(0.43032621745379124, 4.21699049299095),
#(0.4724134263578606, 4.97109049580174),
#(0.5352908028789819, 6.210607271798272),
#(0.6032153419644251, 7.04203136223865),
#(0.7000509094461991, 8.156784062344245),
#(0.8133072364758862, 9.370595121422214),
#(0.9576576108706533, 10.951198035604024),
#(1.179309049638732, 11.913014613681622),
#(1.2113668536847357, 11.387193756560812),
#(1.504215331575233, 11.401685603508392),
#(1.8200846077570811, 10.710407085237636),
#(2.0897335636896592, 9.890963396035415),
#(2.471967694595987, 8.65602795995941),
#(2.8441853884810167, 7.498353573211225),
#(3.2482149485585103, 6.445507571166759),
#(3.7003649312170075, 5.366320782886981),
#(4.180491974291763, 4.457837969348195),
#(4.808512383936856, 3.6173613126160578),
#(5.470713150624783, 3.0792579819473738)]
#
#raw_upper_xy = [
#(0.30084836999382264, 3.805905160589095),
#(0.34690573799340846, 4.576735843524362),
#(0.38111736257902173, 5.220014816551007),
#(0.426970884072522, 6.591157962364919),
#(0.4711037696590693, 7.98874553196312),
#(0.5367951840908125, 9.897334902989368),
#(0.6717019335882877, 12.432054693069656),
#(0.7997510840475223, 14.690403861231864),
#(0.9831381603056255, 17.76183583611369),
#(1.1883422252347362, 18.987544257715196),
#(1.188684791469186, 18.076564237377973),
#(1.3992771603334924, 18.364319060976992),
#(1.802280485540059, 17.346143567038677),
#(2.1946457581225403, 15.206809492258982),
#(2.5665052773436443, 13.268587140979799),
#(2.98570531610029, 11.3110034842024),
#(3.5228324277030354, 9.05077761539455),
#(3.991230674822308, 7.462345823337889),
#(4.483247483463348, 6.288885329270347),
#(5.0446339737459915, 5.295261746211714),
#(5.5488626217715, 4.807305980304189)
#]
#
###
## Fit polynomial in two segments to handle discontinuity near ~1.2 microns
#
#xl, yl = np.array(raw_lower_xy).T
#xu, yu = np.array(raw_upper_xy).T
#
#ppars_l1 = np.polyfit(xl[xl < 1.1886], np.log10(yl[xl < 1.1886]), 3)
#ppars_l2 = np.polyfit(xl[xl >= 1.1886], np.log10(yl[xl >= 1.1886]), 3)
#ppars_u1 = np.polyfit(xu[xu < 1.1886], np.log10(yu[xu < 1.1886]), 3)
#ppars_u2 = np.polyfit(xu[xu >= 1.1886], np.log10(yu[xu >= 1.1886]), 3)
#
#def get_yl(x):
#    if x < 1.1886:
#        polyfunc = np.poly1d(ppars_l1)
#    else:
#        polyfunc = np.poly1d(ppars_l2)
#
#    return 10**polyfunc(x)
#
#def get_yu(x):
#    if x < 1.1886:
#        polyfunc = np.poly1d(ppars_u1)
#    else:
#        polyfunc = np.poly1d(ppars_u2)
#
#    return 10**polyfunc(x)
#
#xfine = np.arange(0.3, 5.3, 0.1)
#
#yl_fin = [get_yl(xx) for xx in xfine]
#yu_fin = [get_yu(xx) for xx in xfine]

_yl = [2.27,3.682,5.314,6.948,8.383,9.505,10.313,10.904,11.44,11.606,
11.511,11.384,11.227,11.043,10.835,10.605,10.357,10.093,9.816,9.53,
9.236,8.937,8.635,8.333,8.031,7.733,7.439,7.151,6.87,6.596,6.331,
6.075,5.83,5.594,5.369,5.154,4.951,4.758,4.576,4.405,4.244,4.094,
3.954,3.824,3.704,3.594,3.494,3.403,3.321,3.248]

_yu = [3.688,5.925,8.5,11.081,13.358,15.149,16.446,17.391,18.227,18.436,
18.312,18.132,17.899,17.618,17.294,16.932,16.538,16.115,15.67,15.206,14.729,
14.243,13.751,13.258,12.766,12.279,11.799,11.329,10.87,10.425,9.994,9.579,
9.18,8.799,8.436,8.09,7.763,7.454,7.164,6.891,6.636,6.399,6.179,5.975,
5.789,5.619,5.464,5.326,5.203,5.095]

_x = [0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1. , 1.1, 1.2, 1.3, 1.4, 1.5,
      1.6, 1.7, 1.8, 1.9, 2. , 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8,
      2.9, 3. , 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7, 3.8, 3.9, 4. , 4.1,
      4.2, 4.3, 4.4, 4.5, 4.6, 4.7, 4.8, 4.9, 5. , 5.1, 5.2]

_mean = [0.5 * (_yl[i] + _yu[i]) for i in range(len(_x))]
_err = [(_yu[i] - _mean[i], _mean[i] - _yl[i]) for i in range(len(_x))]

data = \
{
 'waves': _x,
 'mean': _mean,
 'err': _err,
}
def get_ebl_spectrum():
    return data['waves'], data['mean'], data['err']
